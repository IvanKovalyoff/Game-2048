const t=new class{constructor(t){this.size=4,this.score=0,this.status="idle",this.board=t?t.map(t=>[...t]):Array.from({length:this.size},()=>Array(this.size).fill(0))}createBoard(){return Array.from({length:this.size},()=>Array(this.size).fill(0))}moveLeft(){this.move(t=>t,t=>t.reverse(),t=>t.reverse())&&this.afterMove()}moveRight(){this.move(t=>t.reverse(),t=>t.reverse(),t=>t)&&this.afterMove()}moveUp(){this.moveColumns(t=>t,t=>t.reverse(),t=>t.reverse())&&this.afterMove()}moveDown(){this.moveColumns(t=>t.reverse(),t=>t.reverse(),t=>t)&&this.afterMove()}getScore(){return this.score}getState(){return this.board.map(t=>[...t])}getStatus(){return this.status}start(){this.score=0,this.status="playing",this.board=this.createBoard(),this.addRandomTile(),this.addRandomTile()}restart(){this.start()}addRandomTile(){let t=[];for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)0===this.board[e][s]&&t.push([e,s]);if(0===t.length)return;let[e,s]=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}move(t,e,s){let r=!1;for(let i=0;i<this.size;i++){let a=[...this.board[i]];a=t(a);let o=[],l=a.filter(t=>0!==t);for(let t=0;t<l.length-1;t++)l[t]===l[t+1]&&(l[t]*=2,this.score+=l[t],l[t+1]=0,o.push(t));let h=l.filter(t=>0!==t);for(;h.length<this.size;)h.push(0);let n=s(e(h));n.toString()!==this.board[i].toString()&&(r=!0),this.board[i]=n}return r}moveColumns(t,e,s){let r=!1;for(let i=0;i<this.size;i++){let a=[];for(let e=0;e<this.size;e++)a.push(this.board[e][i]),a=t(a);let o=a.filter(t=>0!==t);for(let t=0;t<o.length-1;t++)o[t]===o[t+1]&&(o[t]*=2,this.score+=o[t],o[t+1]=0);let l=o.filter(t=>0!==t);for(;l.length<this.size;)l.push(0);let h=s(e(l));for(let t=0;t<this.size;t++)this.board[t][i]!==h[t]&&(r=!0),this.board[t][i]=h[t]}return r}afterMove(){this.addRandomTile(),this.checkStatus()}checkStatus(){if(this.board.flat().includes(2048)){this.status="win";return}if(this.board.flat().includes(0)){this.status="playing";return}for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++){let s=this.board[t][e];if(t<this.size-1&&s===this.board[t+1][e]||e<this.size-1&&s===this.board[t][e+1]){this.status="playing";return}}this.status="lose"}},e=document.querySelector(".button"),s=document.querySelector(".game-score"),r=document.querySelectorAll(".field-cell"),i=document.querySelector(".message-start"),a=document.querySelector(".message-win"),o=document.querySelector(".message-lose");function l(){let e=t.getState(),l=0;for(let t=0;t<4;t++)for(let s=0;s<4;s++){let i=e[t][s],a=r[l];l++,a.textContent=0===i?"":i,a.className="field-cell",0!==i&&a.classList.add(`field-cell--${i}`)}s.textContent=t.getScore(),i.classList.add("hidden"),a.classList.add("hidden"),o.classList.add("hidden"),"win"===t.getStatus()?a.classList.remove("hidden"):"lose"===t.getStatus()&&o.classList.remove("hidden")}e.addEventListener("click",()=>{t.start(),l(),e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart"}),document.addEventListener("keydown",s=>(function(s){if("playing"===t.getStatus()){switch(s){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;default:return}l(),e.classList.contains("start")&&(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart")}})(s.key)),l();
//# sourceMappingURL=index.4b771011.js.map
